<!DOCTYPE html>
<html lang="ru">

<!--HEAD-->
<head>
    <title class="body-title">Личный Кабинет&nbsp;|&nbsp;</title>
    <link rel="shortcut icon" href="static/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">

    <script src="static/js/jquery-3.1.0.min.js"></script>
    <script src="static/js/jquery-ui.min.js"></script>
    <script src="static/js/jquery.ui.touch-punch.js"></script>
    <script src="static/js/jquery.mjs.nestedSortable.js"></script>
    <script src="static/js/sign.js"></script>
    <script src="static/js/atol-api.js"></script>

    <link rel="stylesheet" href="static/css/w3.css">
    <link rel="stylesheet" href="static/css/w3-theme-red.css">
    <link rel="stylesheet" href="static/css/font-awesome.min.css">
    <link rel="stylesheet" href="static/css/style.css">

</head>

<body class="w3-white">

<a href="http://www.atol.ru/">
    <img class="" src="static/img/logo.png" alt="АТОЛ"
         style="vertical-align: bottom;position: absolute;right:25px;top:10px;"
         width="87" height="23">
</a>

<!--HEADER (NAV)-->

<nav id="open-menu" class="w3-sidenav w3-theme w3-card-2 w3-large w3-left-align" style="display:none; width:100%">
    <a class="w3-hover-none w3-hover-text-theme" onclick="openMenu();"><i
            class="fa fa-fw fa-times"></i></a>
    <a class="my-active w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-cogs"></i>&nbsp;Панель управления</a>
    <a class="my-disactive w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-envelope-o"></i>&nbsp;Почтовый ящик</a>
    <a class="menu-name my-disactive w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-user"></i>&nbsp;Учётная запись</a>
    <a onclick="signOut();" class="w3-hover-none w3-hover-text-theme">
        <i class="fa fa-fw fa-sign-out"></i>&nbsp;Выход</a>
</nav>


<!--<div class="w3-col l1 w3-hide-small w3-hide-medium">&nbsp;</div>-->
<div class="w3-row-padding w3-margin-left">
    <h5 class="body-title w3-hide-small">Личный Кабинет&nbsp;|&nbsp;</h5>
</div>

<ul class="w3-padding-small w3-navbar  w3-card-2 w3-light-grey w3-margin-bottom w3-text-dark-grey">

    <!--<li class="w3-col l1 m1 w3-hide-small w3-hide-medium">&nbsp;</li>-->

    <li class="w3-hide-medium w3-hide-large w3-opennav">
        <a class="w3-hover-none w3-hover-text-theme" onclick="openMenu();"><i
                class="fa fa-fw fa-bars"></i></a>
    </li>

    <li class="w3-hide-small w3-hide-medium"><a class="my-active w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-cogs"></i>&nbsp;Панель управления</a></li>
    <li class="w3-hide-small w3-hide-medium"><a class="my-disactive w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-envelope-o"></i>&nbsp;Почтовый ящик</a></li>
    <li class="w3-hide-small w3-hide-medium"><a class="menu-name my-disactive w3-hover-none w3-hover-text-theme"
                                                href="#">
        <i class="fa fa-fw fa-user"></i>&nbsp;Учётная запись</a></li>
    <li class="w3-hide-small w3-hide-medium"><a onclick="signOut();" class="w3-hover-none w3-hover-text-theme">
        <i class="fa fa-fw fa-sign-out"></i>&nbsp;Выход</a></li>

    <li class="w3-hide-small w3-hide-large"><a class="my-active w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-cogs"></i></a></li>
    <li class="w3-hide-small w3-hide-large"><a class="my-disactive w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-envelope-o"></i></a></li>
    <li class="w3-hide-small w3-hide-large"><a class="my-disactive w3-hover-none w3-hover-text-theme" href="#">
        <i class="fa fa-fw fa-user"></i></a></li>
    <li class="w3-hide-small w3-hide-large"><a onclick="signOut();" class="w3-hover-none w3-hover-text-theme">
        <i class="fa fa-fw fa-sign-out"></i></a></li>

    <!--<li class="w3-col l2 m2 w3-hide-small">&nbsp;</li>-->
</ul>

<div class="w3-row">
    <div class="w3-col l1 w3-hide-small w3-hide-medium w3-hide-large">&nbsp;</div>

    <div class="w3-col l12 m12 s12">
        <!--w3-border-left w3-border-right w3-border-bottom w3-border-light-grey -->
        <div class="w3-row w3-card-2 w3-animate-opacity">
            <!--Дерево Хабов-->
            <div class="w3-border-left w3-border-right w3-col l4 m4 s12">


                <!--<div class="w3-row">-->
                <header class="w3-border-bottom w3-theme w3-text-dark-grey w3-padding-small">
                    <h5 class="w3-margin-left w3-margin-right"><i class="fa fa-fw fa-sitemap"></i>&nbsp;Все HUB'ы
                        <a class="w3-right w3-hover-none w3-hover-text-dark-grey" href="#">
                            <i id="save" class="fa fa-fw fa-floppy-o"></i></a>
                    </h5>
                </header>
                <div class="w3-light-grey w3-text-dark-grey" id="scroll" style="height:70vh; overflow-y:scroll;">
                    <ul class="sortable">
                        <li id="rootHub">
                            <div class="tab-root active-elem">
                                <i class="fa fa-fw fa-folder" style="display:none;"></i>
                                <i class="fa fa-fw fa-folder-open"></i>
                                &nbsp;<a></a>
                            </div>
                            <ul>
                            </ul>
                        </li>
                    </ul>
                </div>
                <footer class="w3-border-top w3-white w3-text-dark-grey w3-large">
                    <div class="w3-btn-bar w3-show-inline-block">
                        <a onclick="$('#modal-group').show();" id="panel-group"
                           class="my-labeled w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-folder-o"></i>
                            <i class="my-label w3-small fa fa-fw fa-plus"></i>
                        </a>

                        <a onclick="$('#modal-hub').show();" id="panel-hub"
                           class="my-labeled w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-laptop"></i>
                            <i class="my-label w3-small fa fa-fw fa-plus"></i>
                        </a>

                        <a onclick="$('#modal-rename-group').show();" id="panel-rename-group"
                           class="w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-pencil"></i></a>

                        <a onclick="$('#modal-rename-hub').show();" style="display:none" id="panel-rename-hub"
                           class="w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-pencil"></i></a>

                        <a onclick="$('#modal-delete-hub').show();" style="display:none" id="panel-delete-hub"
                           class="w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-trash-o"></i></a>

                        <a onclick="$('#modal-delete-group').show();" style="display:none" id="panel-delete-group"
                           class="w3-btn w3-hover-none w3-hover-text-theme">
                            <i class="fa fa-fw fa-trash-o"></i></a>

                        <div class="w3-btn w3-text-white w3-hover-none" style="cursor:default">
                        <i class="fa fa-fw fa-repeat"></i>
                        </div>
                    </div>
                </footer>
                <!--</div>-->
                <!--<br class="w3-light-grey w3-hide-medium w3-hide-large">-->

            </div>

            <div class="w3-border-left w3-border-right w3-col l8 m8 s12">

                <!--Статистика для выбранного Хаба-->

                <header class="w3-border-bottom w3-theme w3-text-dark-grey w3-padding-small">
                    <h5 class="w3-margin-left w3-margin-right"><i class="fa fa-fw fa-sliders"></i>&nbsp;
                        <text id="dashboard-group"></text>
                        <text style="display:none" id="dashboard-hub"></text>
                        <a class="w3-right w3-hover-none w3-hover-text-dark-grey" href="#">
                            <i id="reload" class="fa fa-fw fa-repeat"></i></a>
                    </h5>
                </header>
                <div class="w3-light-grey" style="height:70vh">

                </div>

                <!--Дополнительные настройки-->

                <footer class="w3-border-top w3-white w3-text-dark-grey w3-large">
                    <div class="w3-btn-bar w3-show-inline-block">
                        <a class="w3-btn w3-hover-none w3-hover-text-theme" href="#">
                            <i class="fa fa-fw fa-pencil"></i></a>
                    </div>
                </footer>

            </div>
        </div>

        <!--FOOTER-->
        <br class="w3-hide-medium w3-hide-large">
        <br class="w3-hide-medium w3-hide-large">
        <footer class="w3-hide-large w3-hide-medium">
            <ul class="w3-navbar w3-center">
                <li>
                    <a class="w3-hover-none" href="http://www.atol.ru/">
                        <img src="static/img/logo.png" alt="АТОЛ" width="87" height="23">
                    </a>
                </li>
            </ul>
        </footer>

    </div>
    <div class="w3-col l2 w3-hide-small w3-hide-medium w3-hide-large">&nbsp;</div>
</div>


<!--MODALS-->
<div id="modal-group" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
      <span onclick="$('#modal-group').hide();"
            class="w3-closebtn">&times;</span>
            <h2>Добавление группы</h2>
        </header>

        <form id="group-form" class="w3-container">
            <div class="w3-group">
                <input class="w3-input w3-border" type="text" name="name" required>
                <label class="w3-label w3-validate">Придумайте имя новой группы</label>
            </div>
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="addGroup();" type="submit">Создать группу</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-group').hide();">Отмена
                </a>
            </div>
        </form>
    </div>
</div>

<div id="modal-hub" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
      <span onclick="$('#modal-hub').hide();"
            class="w3-closebtn">&times;</span>
            <h2>Добавление Хаба</h2>
        </header>

        <form id="hub-form" class="w3-container">
            <div class="w3-group">
                <input class="w3-input w3-border" type="text" name="device_id" required>
                <label id="hub-label" class="w3-label w3-validate">Введите идентификатор Хаба</label>
            </div>
            <div class="w3-group">
                <input class="w3-input w3-border" type="text" name="name" required>
                <label class="w3-label w3-validate">Придумайте имя Хаба</label>
            </div>
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="addHub();" type="submit">Добавить Хаб</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-hub').hide();">Отмена
                </a>
            </div>
        </form>
    </div>
</div>

<div id="modal-rename-hub" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
            <span onclick="$('#modal-rename-hub').hide();" class="w3-closebtn">&times;</span>
            <h2>Новое имя Хаба</h2>
        </header>

        <form id="rename-form-hub" class="w3-container">
            <div class="w3-group">
                <input class="w3-input w3-border" type="text" name="name" required>
                <label class="w3-label w3-validate">Введите новое имя Хаба</label>
            </div>
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="renameHub();" type="submit">Переименовать</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-rename-hub').hide();">Отмена
                </a>
            </div>
        </form>
    </div>
</div>

<div id="modal-rename-group" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
            <span onclick="$('#modal-rename-group').hide();" class="w3-closebtn">&times;</span>
            <h2>Новое имя Группы</h2>
        </header>

        <form id="rename-form-group" class="w3-container">
            <div class="w3-group">
                <input class="w3-input w3-border" type="text" name="name" required>
                <label class="w3-label w3-validate">Введите новое имя Группы</label>
            </div>
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="renameGroup();" type="submit">Переименовать</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-rename-group').hide();">Отмена
                </a>
            </div>
        </form>
    </div>
</div>

<div id="modal-delete-group" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
            <span onclick="$('#modal-delete-group').hide();" class="w3-closebtn">&times;</span>
            <h2>Удаление Группы</h2>
        </header>

        <div class="w3-container">
            <h4>Вы уверены, что хотите удалить эту Группу?</h4>
            <h5>Все дочерние элементы будут также удалены!</h5>
        </div>

        <footer class="w3-container">
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="deleteGroup();">Удалить</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-delete-group').hide();">Отмена</a>
            </div>
        </footer>
    </div>
</div>

<div id="modal-delete-hub" class="w3-modal">
    <div class="w3-modal-content w3-card-2">
        <header class="w3-container w3-theme">
            <span onclick="$('#modal-delete-hub').hide();" class="w3-closebtn">&times;</span>
            <h2>Удаление Хаба</h2>
        </header>

        <div class="w3-container">
            <h4>Вы уверены, что хотите удалить этот Хаб?</h4>
        </div>

        <footer class="w3-container">
            <div class="w3-group">
                <a class="w3-btn w3-theme w3-large" onclick="deleteHub();">Удалить</a>
                <a class="w3-btn w3-right w3-light-grey w3-large" onclick="$('#modal-delete-hub').hide();">Отмена</a>
            </div>
        </footer>
    </div>
</div>

<script>
getUserInfo();
getTree();

$(document).ready(function(){

    reloadTree();

});


//////Скрытие/открытие папок
//Корень
$('.sortable').on('click', '.tab-root > i', function() {
    $(this).closest( "li" ).children("ul").toggle("fast");
    $(this).parent().children("i").toggle();
});

//Папка
$('.sortable').on('click', '.tab > div > i', function() {
    $(this).closest( "li" ).children("ul").toggle("fast");
    $(this).parent().children("i").toggle();
});


//////Выбор элементов
//Корень
$('.sortable').on('click', '.tab-root > a', function() {
    $('.active-elem').removeClass("active-elem");
    $(this).parent().addClass("active-elem");

    $('#panel-group').show("fast");
    $('#panel-hub').show("fast");
    $('#panel-rename-group').show("fast");
    $('#panel-rename-hub').hide("fast");
    $('#panel-delete-hub').hide("fast");
    $('#panel-delete-group').hide("fast");

    $('#dashboard-group').html($(this).parent().children("a").html());
    $('#dashboard-hub').hide();
    $('#dashboard-group').show();
});

//Папка
$('.sortable').on('click', '.tab > div > a', function() {
    $('.active-elem').removeClass("active-elem");
    $(this).parent().addClass("active-elem");
    $('#panel-group').show("fast");
    $('#panel-hub').show("fast");
    $('#panel-rename-group').show();
    $('#panel-rename-hub').hide();
    $('#panel-delete-hub').hide();
    $('#panel-delete-group').show();

    $('#dashboard-group').html($(this).parent().children("a").html());
    $('#dashboard-hub').hide();
    $('#dashboard-group').show();
});

//Хаб
$('.sortable').on('click', '.hub > div > a', function() {
    $('.active-elem').removeClass("active-elem");
    $(this).parent().addClass("active-elem");
    $('#panel-group').hide("fast");
    $('#panel-hub').hide("fast");
    $('#panel-rename-group').hide();
    $('#panel-rename-hub').show();
    $('#panel-delete-hub').show();
    $('#panel-delete-group').hide();

    $('#dashboard-hub').html($(this).parent().children("a").html());
    $('#dashboard-group').hide();
    $('#dashboard-hub').show();
});


//////Кнопки под деревом




</script>
</body>
</html>
